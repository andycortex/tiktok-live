generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  id        Int      @id @default(autoincrement())
  nombre    String
  apellido  String
  email     String   @unique
  password  String
  whatsapp  String
  ciudad    String
  direccion String
  empresa   String
  tiktok    String
  passwordResetToken   String?   @unique
  passwordResetExpires DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model product {
  id          Int      @id @default(autoincrement())
  name        String
  code        String   @unique
  category    String
  price       Float
  stock       Int
  visibility  String   @default("public")
  status      String   @default("active")
  description String?
  image       String?  @db.LongText
  createdAt   DateTime @default(now())
  updatedAt   DateTime    @updatedAt
  orderItems  orderItem[]
}

model seller {
  id          Int      @id @default(autoincrement())
  firstName   String
  lastName    String
  email       String   @unique
  phone       String
  status      String   @default("active")
  commission  Float    @default(0)
  createdAt   DateTime @updatedAt
  updatedAt   DateTime @updatedAt
  orders      order[]
}

model zone {
  id           Int      @id @default(autoincrement())
  name         String
  region       String
  price        Float
  deliveryTime String
  instructions String?
  schedule     String?
  coverage     String?
  status       String   @default("active")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  orders       order[]
}

model order {
  id            Int         @id @default(autoincrement())
  customerName  String
  customerPhone String
  status        String      @default("pendiente") // pendiente, confirmado, en_camino, entregado, cancelado
  total         Float
  shippingCost  Float
  sellerId      Int?
  seller        seller?     @relation(fields: [sellerId], references: [id])
  zoneId        Int?
  zone          zone?       @relation(fields: [zoneId], references: [id])
  items         orderItem[]
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

model orderItem {
  id        Int      @id @default(autoincrement())
  orderId   Int
  order     order    @relation(fields: [orderId], references: [id])
  productId Int
  product   product  @relation(fields: [productId], references: [id])
  quantity  Int
  price     Float
}